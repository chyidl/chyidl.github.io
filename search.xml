<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>micro-services</title>
    <url>/2021/09/01/micro-services/</url>
    <content><![CDATA[<p>ä»‹ç»å¾®æœåŠ¡æ¶æ„è®¾è®¡</p>
<span id="more"></span>

<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Hello, world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
      </categories>
      <tags>
        <tag>å¾®æœåŠ¡</tag>
        <tag>DDD</tag>
        <tag>åˆ†å¸ƒå¼</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo-next-gitalk</title>
    <url>/2021/09/01/hexo-next-gitalk/</url>
    <content><![CDATA[<h3 id="ç«™ç‚¹æ­å»ºè¿‡ç¨‹"><a href="#ç«™ç‚¹æ­å»ºè¿‡ç¨‹" class="headerlink" title="ç«™ç‚¹æ­å»ºè¿‡ç¨‹"></a>ç«™ç‚¹æ­å»ºè¿‡ç¨‹</h3><ul>
<li><a href="https://hexo.io/zh-cn/">hexo</a> : å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ ¡çš„åšå®¢æ¡†æ¶</li>
<li><a href="https://github.com/next-theme/hexo-theme-next/blob/master/docs/zh-CN/README.md">next</a> : Hexoä¸»é¢˜</li>
<li><a href="https://github.com/gitalk/gitalk">gitalk</a> : ä¾é GitHub issueçš„è¯„è®ºç³»ç»Ÿ</li>
</ul>
<span id="more"></span>

<h3 id="Settings-amp-Tips"><a href="#Settings-amp-Tips" class="headerlink" title="Settings &amp; Tips"></a>Settings &amp; Tips</h3><ul>
<li><strong>Show descripion</strong><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¿®æ”¹themes/next/_config.yml</span><br><span class="line">excerpt_description: true</span><br><span class="line"></span><br><span class="line"># æ–‡ç« æˆªæ–­</span><br><span class="line">&lt;!--more--&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker Tips &amp; Tricks</title>
    <url>/2021/09/01/docker/</url>
    <content><![CDATA[<h2 id="Docker-Info"><a href="#Docker-Info" class="headerlink" title="Docker  Info"></a>Docker  Info</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€</span><br><span class="line"></span><br><span class="line">CgroupsæŠ€æœ¯æ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µ</span><br><span class="line">NamespaceæŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è¯•å›¾çš„ä¸»è¦æ–¹æ³•</span><br></pre></td></tr></table></figure>
<span id="more"></span>

<h2 id="Docker-Tips"><a href="#Docker-Tips" class="headerlink" title="Docker Tips"></a>Docker Tips</h2><ul>
<li><p><strong>Docker Tip #1</strong>: Docker å®¹å™¨è¿›ç¨‹</p>
<blockquote>
<p>A Docker container is just a process/service that runs directly on your machine. It is slightly different than a regular process because the Docker daemon along with the linux kernel do a few things(<strong>Cgroups</strong>ã€<strong>Namespace</strong>) to ensure it runs in total isolation<br>Dockerå®¹å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹,å’Œè™šæ‹Ÿæœºå·®åˆ«å¾ˆå¤§</p>
</blockquote>
</li>
<li><p><strong>Docker Tip #2</strong>: COPY vs. ADD in a Dockerfile</p>
<blockquote>
<p>COPY å’Œ ADD åŠŸèƒ½å¾ˆç›¸ä¼¼ï¼Œéƒ½å¯ä»¥ä»æŒ‡å®šç›®å½•æ‹·è´æ•°æ®åˆ°Dockeré•œåƒä¸­.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># COPY å’Œ ADD åŒºåˆ«</span><br><span class="line">1. COPY: åªèƒ½ä»æœ¬æœºæ–‡ä»¶æˆ–ç›®å½•ä¸­æ‹·è´åˆ°é•œåƒä¸­</span><br><span class="line">2. ADD: ä¸ä»…å¯ä»¥ä»æœ¬æœºæ–‡ä»¶æˆ–ç›®å½•ä¸­æ‹·è´ï¼Œè¿˜å¯ä»¥ä½¿ç”¨URLå¼•å…¥å¤–éƒ¨çš„æ–‡ä»¶åœ°å€æ‹·è´åˆ°é•œåƒä¸­</span><br><span class="line">  $ ADD rootfs.tar.gz /</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #3</strong>: è¿½åŠ  Docker Run æŒ‡ä»¤å‡å°‘é•œåƒå¤§å°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Before Dockerfile -- æ–°å¢ä¸‰ä¸ªå±‚lager</span><br><span class="line">RUN wget -O myfile.tar.gz http://example.com/myfile.tar.gz</span><br><span class="line">RUN tar -xvf myfile.tar.gz -C /usr/src/myapp</span><br><span class="line">RUN rm myfile.tar.gz</span><br><span class="line"></span><br><span class="line"># After Dockerfile -- æ–°å¢ä¸€ä¸ªå±‚layer</span><br><span class="line">RUN wget -O myfile.tar.gz http://example.com/myfile.tar.gz \</span><br><span class="line">  &amp;&amp; tar -xvf myfile.tar.gz -C /usr/src/myapp \</span><br><span class="line">  &amp;&amp; rm myfile.tar.gz</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #4</strong>: Docker Baseé•œåƒOSå’ŒHost OSæ²¡æœ‰å…³ç³»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Docker Image OS: å®šä¹‰åœ¨Dockerfileæ–‡ä»¶çš„Baseé•œåƒçš„ç³»ç»Ÿ</span><br><span class="line">Host OS: è¿è¡ŒDocker imageçš„ç¯å¢ƒ</span><br><span class="line">You can use whatever base image you want for your Docker images.</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #5</strong>: ä½¿ç”¨ç›¸åŒBaseé•œåƒçš„å¥½å¤„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">You could use a different base OS for each Docker image, but then you lose out on the ability to cache it across all of your images</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #6</strong>: RUN vs. CMD in a Dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RUN: åœ¨é•œåƒå†…æ‰§è¡Œå‘½ä»¤ï¼Œè¿™äº›æŒ‡ä»¤ä»…ä»…åœ¨æ„å»ºbuildé•œåƒä¸­æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”å°†æ„å»ºç»“æœå†™å…¥æ–°largerå±‚ä¸­.</span><br><span class="line">CMD: åœ¨å¯åŠ¨å®¹å™¨æ—¶å®šä¹‰é»˜è®¤çš„è¿è¡Œçš„æŒ‡ä»¤, è¿™ç§åŠ¨ä½œå‘ç”Ÿè¿è¡Œæ—¶run-time</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #7</strong>: Base Docker Image Alpine</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Why Alpine?</span><br><span class="line">&gt; Small. Simple. Secure. Alpine Linux is a security-oriented, lightweight Linux distribution based on musl libc and busybox.</span><br><span class="line">&gt; Alpine is about 30x smaller than Debian.</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #8</strong>: Project Structure with Multiple Dockerfiles and Docker Compose</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ubuntu in ~/chyi/micro-services at 3BPlus on ğŸ³ v20.10.8</span><br><span class="line">âœ tree -L 2</span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ auth</span><br><span class="line">â”‚Â Â  â””â”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ billing</span><br><span class="line">â”‚Â Â  â””â”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ contact</span><br><span class="line">â”‚Â Â  â””â”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ docker-compose.yml</span><br><span class="line">â””â”€â”€ user</span><br><span class="line">    â””â”€â”€ Dockerfile</span><br><span class="line"></span><br><span class="line">4 directories, 5 files</span><br><span class="line"></span><br><span class="line">The docker-compose.yaml</span><br><span class="line">ubuntu in ~/chyi/micro-services at 3BPlus on ğŸ³ v20.10.8</span><br><span class="line">âœ cat docker-compose.yml</span><br><span class="line">version: &#x27;3&#x27;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">    auth:</span><br><span class="line">        build: &#x27;./auth&#x27;</span><br><span class="line">    billing:</span><br><span class="line">        build: &#x27;./billing&#x27;</span><br><span class="line">    contact:</span><br><span class="line">        build: &#x27;./contact&#x27;</span><br><span class="line">    user:</span><br><span class="line">        build: &#x27;./user&#x27;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #9</strong>: ä½¿ç”¨Volumes</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># docker-compose.yaml</span><br><span class="line">services:</span><br><span class="line">  app:</span><br><span class="line">    # Mount the crrent directoy into `/app` inside the running container.</span><br><span class="line">    volumes:</span><br><span class="line">      - &#x27;.:/app&#x27;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #10</strong>: Published Ports</p>
<blockquote>
<p>Creates a firwaall rule which maps a container port to a port on the Docker host to the outside world.</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Flag value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-p 8080:80</td>
<td align="left">Map TCP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td align="left">-p 192.168.1.100:8080:80</td>
<td align="left">Map TCP port 80 in the container to port 8080 on the Docker host for connections to host IP 192.168.1.100.</td>
</tr>
<tr>
<td align="left">-p 8080:80/udp</td>
<td align="left">Map UDP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td align="left">-p 8080:80/tcp -p 8080:80/udp</td>
<td align="left">Map TCP port 80 in the container to TCP port 8080 on the Docker host, and map UDP port 80 in the container to UDP port 8080 on the Docker host.</td>
</tr>
</tbody></table>
<ul>
<li><p><strong>Docker Tip #11</strong>: dockerignore file</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.dockerignore: ignore certain files and folders from your Docker images</span><br><span class="line">  .git</span><br><span class="line">  .dockerignore</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #12</strong>: Manage Docker without sudo on Linux</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Add a docker group and then add your user to it:</span><br><span class="line">$ sudo groupadd docker</span><br><span class="line">$ docker usermod -aG docker $USER</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>Docker</tag>
        <tag>Dockerfile</tag>
      </tags>
  </entry>
</search>
