

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="chyi">
  <meta name="keywords" content="">
  
    <meta name="description" content="Docker  Info1234å®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€CgroupsæŠ€æœ¯æ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µNamespaceæŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è¯•å›¾çš„ä¸»è¦æ–¹æ³•">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker Tips &amp; Tricks">
<meta property="og:url" content="http://chyidl.github.io/2021/09/01/Docker-Intro/">
<meta property="og:site_name" content="Stay Hungry Stay Foolish">
<meta property="og:description" content="Docker  Info1234å®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€CgroupsæŠ€æœ¯æ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µNamespaceæŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è¯•å›¾çš„ä¸»è¦æ–¹æ³•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://chyidl.github.io/misc/images/architecture.svg">
<meta property="og:image" content="http://chyidl.github.io/misc/images/docker-network-host.png">
<meta property="og:image" content="http://chyidl.github.io/misc/images/docker-network-container.png">
<meta property="og:image" content="http://chyidl.github.io/misc/images/docker-network-none.png">
<meta property="og:image" content="http://chyidl.github.io/misc/images/docker-network-bridge.png">
<meta property="article:published_time" content="2021-09-01T01:49:58.000Z">
<meta property="article:modified_time" content="2022-01-05T08:13:40.538Z">
<meta property="article:author" content="chyi">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://chyidl.github.io/misc/images/architecture.svg">
  
  
  <title>Docker Tips &amp; Tricks - Stay Hungry Stay Foolish</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"chyidl.github.io","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Stay Hungry Stay Foolish" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Docker Tips &amp; Tricks">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-09-01 09:49" pubdate>
        2021å¹´9æœˆ1æ—¥ ä¸Šåˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      22k å­—
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      181 åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Docker Tips &amp; Tricks</h1>
            
            <div class="markdown-body">
              <h2 id="Docker-Info"><a href="#Docker-Info" class="headerlink" title="Docker  Info"></a>Docker  Info</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs oxygene">å®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€<br><br>CgroupsæŠ€æœ¯æ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µ<br><span class="hljs-keyword">Namespace</span>æŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è¯•å›¾çš„ä¸»è¦æ–¹æ³•<br></code></pre></td></tr></table></figure>
<span id="more"></span>

<h2 id="Docker-architecture"><a href="#Docker-architecture" class="headerlink" title="Docker architecture"></a>Docker architecture</h2><blockquote>
<p>Docker uses a client-server architecture.</p>
</blockquote>
<p><img src="/misc/images/architecture.svg" srcset="/img/loading.gif" lazyload alt="docker architecture"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># Docker ä»“åº“æ“ä½œ</span><br>  docker pull/push<br><br><span class="hljs-comment"># Docker é•œåƒç®¡ç†</span><br>  docker images/rmi/build<br><br><span class="hljs-comment"># Docker ç”Ÿå‘½å‘¨æœŸç®¡ç†</span><br>  docker run/<span class="hljs-built_in">start</span>/stop/<span class="hljs-built_in">rm</span><br><br><span class="hljs-comment"># to delete all containers including its volumes use,</span><br><span class="hljs-variable">$</span> docker <span class="hljs-built_in">rm</span> <span class="hljs-literal">-vf</span> <span class="hljs-variable">$</span>(docker <span class="hljs-built_in">ps</span> <span class="hljs-literal">-a</span> <span class="hljs-literal">-q</span>)<br><br><span class="hljs-comment"># to delete all Docker images</span><br><span class="hljs-variable">$</span> docker rmi <span class="hljs-variable">$</span>(docker images <span class="hljs-literal">-q</span>)<br><br><span class="hljs-comment"># stop all Docker containers</span><br>&gt; docker <span class="hljs-built_in">ps</span> -- list all running containers<br>&gt;   <span class="hljs-literal">-q</span> flag will only list the IDs <span class="hljs-keyword">for</span> those containers<br><span class="hljs-variable">$</span> docker <span class="hljs-built_in">kill</span> <span class="hljs-variable">$</span>(docker <span class="hljs-built_in">ps</span> <span class="hljs-literal">-q</span>)<br><br><span class="hljs-comment"># Remove all Docker containers</span><br><span class="hljs-variable">$</span> docker <span class="hljs-built_in">rm</span> <span class="hljs-variable">$</span>(docker <span class="hljs-built_in">ps</span> <span class="hljs-literal">-a</span> <span class="hljs-literal">-q</span>)<br></code></pre></td></tr></table></figure>

<h2 id="Docker-Tips"><a href="#Docker-Tips" class="headerlink" title="Docker Tips"></a>Docker Tips</h2><ul>
<li><p><strong>Docker Tip #1</strong>: Docker å®¹å™¨è¿›ç¨‹</p>
<blockquote>
<p>A Docker container is just a process/service that runs directly on your machine. It is slightly different than a regular process because the Docker daemon along with the linux kernel do a few things(<strong>Cgroups</strong>ã€<strong>Namespace</strong>) to ensure it runs in total isolation<br>Dockerå®¹å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹,å’Œè™šæ‹Ÿæœºå·®åˆ«å¾ˆå¤§</p>
</blockquote>
</li>
<li><p><strong>Docker Tip #2</strong>: COPY vs. ADD in a Dockerfile</p>
<blockquote>
<p>COPY å’Œ ADD åŠŸèƒ½å¾ˆç›¸ä¼¼ï¼Œéƒ½å¯ä»¥ä»æŒ‡å®šç›®å½•æ‹·è´æ•°æ®åˆ°Dockeré•œåƒä¸­.</p>
</blockquote>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"># <span class="hljs-keyword">COPY</span> å’Œ <span class="hljs-keyword">ADD</span> åŒºåˆ«<br><span class="hljs-number">1</span>. <span class="hljs-keyword">COPY</span>: åªèƒ½ä»æœ¬æœºæ–‡ä»¶æˆ–ç›®å½•ä¸­æ‹·è´åˆ°é•œåƒä¸­<br><span class="hljs-number">2</span>. <span class="hljs-keyword">ADD</span>: ä¸ä»…å¯ä»¥ä»æœ¬æœºæ–‡ä»¶æˆ–ç›®å½•ä¸­æ‹·è´ï¼Œè¿˜å¯ä»¥ä½¿ç”¨URLå¼•å…¥å¤–éƒ¨çš„æ–‡ä»¶åœ°å€æ‹·è´åˆ°é•œåƒä¸­<br>  $ <span class="hljs-keyword">ADD</span> rootfs.tar.gz /<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #3</strong>: è¿½åŠ  Docker Run æŒ‡ä»¤å‡å°‘é•œåƒå¤§å°</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># Before Dockerfile -- æ–°å¢ä¸‰ä¸ªå±‚lager</span><br>RUN wget -O myfile.tar.gz http:<span class="hljs-regexp">//</span>example.com/myfile.tar.gz<br>RUN tar -xvf myfile.tar.gz -C <span class="hljs-regexp">/usr/</span>src/myapp<br>RUN rm myfile.tar.gz<br><br><span class="hljs-comment"># After Dockerfile -- æ–°å¢ä¸€ä¸ªå±‚layer</span><br>RUN wget -O myfile.tar.gz http:<span class="hljs-regexp">//</span>example.com/myfile.tar.gz \<br>  &amp;&amp; tar -xvf myfile.tar.gz -C <span class="hljs-regexp">/usr/</span>src/myapp \<br>  &amp;&amp; rm myfile.tar.gz<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #4</strong>: Docker Baseé•œåƒOSå’ŒHost OSæ²¡æœ‰å…³ç³»</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">Docker <span class="hljs-built_in">Image</span> OS: å®šä¹‰åœ¨Dockerfileæ–‡ä»¶çš„Baseé•œåƒçš„ç³»ç»Ÿ<br>Host OS: è¿è¡ŒDocker <span class="hljs-built_in">image</span>çš„ç¯å¢ƒ<br>You can use whatever base <span class="hljs-built_in">image</span> you want <span class="hljs-keyword">for</span> your Docker images.<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #5</strong>: ä½¿ç”¨ç›¸åŒBaseé•œåƒçš„å¥½å¤„</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">You could use a different base OS <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> Docker image, but <span class="hljs-keyword">then</span> you lose <span class="hljs-keyword">out</span> <span class="hljs-keyword">on</span> the ability <span class="hljs-keyword">to</span> <span class="hljs-keyword">cache</span> it across all of your images<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #6</strong>: RUN vs. CMD in a Dockerfile</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">RUN:</span> åœ¨é•œåƒå†…æ‰§è¡Œå‘½ä»¤ï¼Œè¿™äº›æŒ‡ä»¤ä»…ä»…åœ¨æ„å»ºbuildé•œåƒä¸­æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”å°†æ„å»ºç»“æœå†™å…¥æ–°largerå±‚ä¸­.<br><span class="hljs-symbol">CMD:</span> åœ¨å¯åŠ¨å®¹å™¨æ—¶å®šä¹‰é»˜è®¤çš„è¿è¡Œçš„æŒ‡ä»¤, è¿™ç§åŠ¨ä½œå‘ç”Ÿè¿è¡Œæ—¶run-time, è¦†ç›–æ–¹å¼<br><span class="hljs-symbol">ENTRYPOINT:</span> æ‰§è¡Œå‘½ä»¤å‚æ•°è¿½åŠ æ–¹å¼<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #7</strong>: Base Docker Image Alpine</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Why Alpine?<br>&gt; Small. Simple. Secure. Alpine Linux is a security-<span class="hljs-keyword">oriented, </span>lightweight Linux <span class="hljs-keyword">distribution </span><span class="hljs-keyword">based </span>on musl libc <span class="hljs-keyword">and </span><span class="hljs-keyword">busybox.</span><br><span class="hljs-keyword"></span>&gt; Alpine is about <span class="hljs-number">30</span>x smaller than Debian.<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #8</strong>: Project Structure with Multiple Dockerfiles and Docker Compose</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs vim">ubuntu in ~/chyi/micro-services at <span class="hljs-number">3</span>BPlus <span class="hljs-keyword">on</span> ğŸ³ v20.<span class="hljs-number">10.8</span><br>âœ tree -L <span class="hljs-number">2</span><br>.<br>â”œâ”€â”€ auth<br>â”‚Â Â  â””â”€â”€ Dockerfile<br>â”œâ”€â”€ billing<br>â”‚Â Â  â””â”€â”€ Dockerfile<br>â”œâ”€â”€ contact<br>â”‚Â Â  â””â”€â”€ Dockerfile<br>â”œâ”€â”€ docker-compose.yml<br>â””â”€â”€ user<br>    â””â”€â”€ Dockerfile<br><br><span class="hljs-number">4</span> directories, <span class="hljs-number">5</span> <span class="hljs-keyword">files</span><br><br>The docker-compose.yaml<br>ubuntu in ~/chyi/micro-services at <span class="hljs-number">3</span>BPlus <span class="hljs-keyword">on</span> ğŸ³ v20.<span class="hljs-number">10.8</span><br>âœ <span class="hljs-keyword">cat</span> docker-compose.yml<br><span class="hljs-keyword">version</span>: <span class="hljs-string">&#x27;3&#x27;</span><br><br>service<span class="hljs-variable">s:</span><br>    auth:<br>        build: <span class="hljs-string">&#x27;./auth&#x27;</span><br>    billin<span class="hljs-variable">g:</span><br>        build: <span class="hljs-string">&#x27;./billing&#x27;</span><br>    contac<span class="hljs-variable">t:</span><br>        build: <span class="hljs-string">&#x27;./contact&#x27;</span><br>    user:<br>        build: <span class="hljs-string">&#x27;./user&#x27;</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #9</strong>: ä½¿ç”¨Volumes</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># docker-compose.yaml</span><br><span class="hljs-attr">services</span>:<span class="hljs-string"></span><br>  <span class="hljs-attr">app</span>:<span class="hljs-string"></span><br><span class="hljs-comment">    # Mount the crrent directoy into `/app` inside the running container.</span><br>    <span class="hljs-attr">volumes</span>:<span class="hljs-string"></span><br>      <span class="hljs-meta">-</span> <span class="hljs-string">&#x27;.:/app&#x27;</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #10</strong>: Published Ports</p>
<blockquote>
<p>Creates a firwaall rule which maps a container port to a port on the Docker host to the outside world.</p>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Flag value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-p 8080:80</td>
<td align="left">Map TCP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td align="left">-p 192.168.1.100:8080:80</td>
<td align="left">Map TCP port 80 in the container to port 8080 on the Docker host for connections to host IP 192.168.1.100.</td>
</tr>
<tr>
<td align="left">-p 8080:80/udp</td>
<td align="left">Map UDP port 80 in the container to port 8080 on the Docker host.</td>
</tr>
<tr>
<td align="left">-p 8080:80/tcp -p 8080:80/udp</td>
<td align="left">Map TCP port 80 in the container to TCP port 8080 on the Docker host, and map UDP port 80 in the container to UDP port 8080 on the Docker host.</td>
</tr>
</tbody></table>
<ul>
<li><p><strong>Docker Tip #11</strong>: dockerignore file</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.dockerignore</span>: ignore certain files and folders from your Docker images<br>  <span class="hljs-string">.git</span><br>  <span class="hljs-string">.dockerignore</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #12</strong>: Manage Docker without sudo on Linux</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-comment"># Add a docker group and then add your user to it:</span><br><span class="hljs-variable">$ </span>sudo groupadd docker<br><span class="hljs-variable">$ </span>docker usermod -aG docker <span class="hljs-variable">$USER</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #13</strong>: Measure Docker Containerâ€™s Resources</p>
<blockquote>
<p>How much resources containers are using</p>
</blockquote>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">$ docker stats<br>CONTAINER ID   NAME                                                                                         <span class="hljs-meta">CPU</span> %     MEM USAGE / LIMIT     MEM %     NET I/O     BLOCK I/O         PIDS<br>298d90f942e1   k8s_POD_kafka-zookeeper-0_default_a243d677-<span class="hljs-number">101b</span>-493b-a076-d94f46785f22_0                     <span class="hljs-number">0.00</span>%     724KiB / <span class="hljs-number">3.</span>704GiB     <span class="hljs-number">0.02</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>           <span class="hljs-number">1</span><br>1d92a13e4a6f   k8s_POD_kafka-0_default_f7374645-<span class="hljs-number">9904</span>-436c-bc8d-43ed415833c1_0                               <span class="hljs-number">0.00</span>%     872KiB / <span class="hljs-number">3.</span>704GiB     <span class="hljs-number">0.02</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>           <span class="hljs-number">1</span><br>b638c1bbd855   k8s_POD_postgres-postgresql-0_infrastructure_d9067ee1-<span class="hljs-number">6874</span>-<span class="hljs-number">4018</span>-a008-09362ad9330d_16         <span class="hljs-number">0.00</span>%     868KiB / <span class="hljs-number">3.</span>704GiB     <span class="hljs-number">0.02</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>           <span class="hljs-number">1</span><br>0fdc76799b4e   k8s_kube-flannel_kube-flannel-<span class="hljs-built_in">ds</span>-nk6tj_kube-system_0a186e7a-c0d7-<span class="hljs-number">4282</span>-9f5d-65ee20d0e13a_12   <span class="hljs-number">0.07</span>%     <span class="hljs-number">15.</span>4MiB / 50MiB       <span class="hljs-number">30.80</span>%    <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">33.</span>1MB / <span class="hljs-number">0B</span>       <span class="hljs-number">11</span><br>4c3705247efa   k8s_kube-proxy_kube-proxy-xwfvl_kube-system_f46216cb-d018-4d82-b510-9be5e01cefca_12          <span class="hljs-number">0.00</span>%     <span class="hljs-number">23.</span>36MiB / <span class="hljs-number">3.</span>704GiB   <span class="hljs-number">0.62</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">43.</span>7MB / <span class="hljs-number">12.</span>3kB   <span class="hljs-number">8</span><br>16d5db1e7447   k8s_POD_kube-proxy-xwfvl_kube-system_f46216cb-d018-4d82-b510-9be5e01cefca_13                 <span class="hljs-number">0.00</span>%     <span class="hljs-number">1.</span>996MiB / <span class="hljs-number">3.</span>704GiB   <span class="hljs-number">0.05</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     487kB / <span class="hljs-number">0B</span>        <span class="hljs-number">1</span><br>496aacf5fddf   k8s_POD_kube-flannel-<span class="hljs-built_in">ds</span>-nk6tj_kube-system_0a186e7a-c0d7-<span class="hljs-number">4282</span>-9f5d-65ee20d0e13a_13            <span class="hljs-number">0.00</span>%     768KiB / <span class="hljs-number">3.</span>704GiB     <span class="hljs-number">0.02</span>%     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>     <span class="hljs-number">0B</span> / <span class="hljs-number">0B</span>           <span class="hljs-number">1</span><br>1e328afeb116   dapr_zipkin                                                                                  <span class="hljs-number">0.17</span>%     <span class="hljs-number">250.</span>2MiB / <span class="hljs-number">3.</span>704GiB   <span class="hljs-number">6.60</span>%     18MB / <span class="hljs-number">0B</span>   60MB / <span class="hljs-number">0B</span>         <span class="hljs-number">55</span><br>27872f88cae3   dapr_placement                                                                               <span class="hljs-number">0.11</span>%     <span class="hljs-number">5.</span>992MiB / <span class="hljs-number">3.</span>704GiB   <span class="hljs-number">0.16</span>%     18MB / <span class="hljs-number">0B</span>   <span class="hljs-number">13.</span>6MB / <span class="hljs-number">0B</span>       <span class="hljs-number">10</span><br>27c1f6daa81c   dapr_redis                                                                                   <span class="hljs-number">0.35</span>%     <span class="hljs-number">5.</span>633MiB / <span class="hljs-number">3.</span>704GiB   <span class="hljs-number">0.15</span>%     18MB / <span class="hljs-number">0B</span>   <span class="hljs-number">10.</span>7MB / <span class="hljs-number">0B</span>       <span class="hljs-number">5</span><br><br>$ docker stats --format <span class="hljs-string">&quot;table &#123;&#123;.Container&#125;&#125;\t&#123;&#123;.CPUPerc&#125;&#125;\t&#123;&#123;.MemUsage&#125;&#125;&quot;</span><br>CONTAINER      <span class="hljs-meta">CPU</span> %     MEM USAGE / LIMIT<br>298d90f942e1   <span class="hljs-number">0.00</span>%     724KiB / <span class="hljs-number">3.</span>704GiB<br>1d92a13e4a6f   <span class="hljs-number">0.00</span>%     872KiB / <span class="hljs-number">3.</span>704GiB<br>b638c1bbd855   <span class="hljs-number">0.00</span>%     868KiB / <span class="hljs-number">3.</span>704GiB<br>0fdc76799b4e   <span class="hljs-number">2.37</span>%     <span class="hljs-number">15.</span>42MiB / 50MiB<br>4c3705247efa   <span class="hljs-number">0.00</span>%     <span class="hljs-number">23.</span>36MiB / <span class="hljs-number">3.</span>704GiB<br>16d5db1e7447   <span class="hljs-number">0.00</span>%     <span class="hljs-number">1.</span>996MiB / <span class="hljs-number">3.</span>704GiB<br>496aacf5fddf   <span class="hljs-number">0.00</span>%     768KiB / <span class="hljs-number">3.</span>704GiB<br>1e328afeb116   <span class="hljs-number">0.21</span>%     <span class="hljs-number">250.</span>2MiB / <span class="hljs-number">3.</span>704GiB<br>27872f88cae3   <span class="hljs-number">0.12</span>%     <span class="hljs-number">5.</span>992MiB / <span class="hljs-number">3.</span>704GiB<br>27c1f6daa81c   <span class="hljs-number">0.34</span>%     <span class="hljs-number">5.</span>633MiB / <span class="hljs-number">3.</span>704GiB<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #14</strong>: Docker Compose vs Docker Stack</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># Docker Compose: is an official tool that helps you manage your Docker containers by letting you define everything through a docker-compose.yml file.</span><br><br><span class="hljs-comment"># docker stack: is a command that&#x27;s embedded into the Docker CLI. Lets you manage a cluster of Docker containers through Docker Swarm.</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #15</strong>: Metadata Docker Images with Labels</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># Dockerfile example of adding 2 labels with 1 LABEL instruction:</span><br><span class="hljs-keyword">LABEL</span><span class="bash"> &lt;key&gt;=&lt;value&gt;</span><br><span class="hljs-keyword">LABEL</span><span class="bash"> version=<span class="hljs-string">&quot;1.0&quot;</span> maintainer=<span class="hljs-string">&quot;chyi &lt;nick.chyi@gmail.com&gt;&quot;</span></span><br><br><span class="hljs-comment"># Docker build example to add dynamic labels to your Docker images:</span><br>$ docker build . --<span class="hljs-keyword">label</span><span class="bash"> <span class="hljs-string">&quot;version=1.0&quot;</span> --label <span class="hljs-string">&quot;maintaner=chyi &lt;nick.chyi@gmail.com&gt;&quot;</span></span><br><br><span class="hljs-comment"># docker inspect images</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #16</strong>: Named Volumes vs Path Based Volumes</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># Named volumes</span><br>  postgres:<span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/postgresql/</span>data<br><br>  docker-compose automatically create the postgres volume, <span class="hljs-keyword">if</span> not you could running __$ docker volume create postgres__.<br>  On Linux, the volume will get saved to <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/docker/</span>volumes<span class="hljs-regexp">/postgres/</span>_data<br><br><span class="hljs-comment"># Path based volumes</span><br>  .<span class="hljs-regexp">/postgres:/</span>var<span class="hljs-regexp">/lib/</span>postgresql/data<br><br>  postgres/ directory would get created <span class="hljs-keyword">in</span> the current directory on the Docker host.<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #17</strong>: The Volume or Mount Flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Setting up a volume the old way with docker run:</span><br>$ docker container run â€¦ -v <span class="hljs-string">&quot;<span class="hljs-subst">$(pwd)</span>&quot;</span>:/myapp<br><br><span class="hljs-comment"># Setting up the same volumes using the mount flag with docker run:</span><br>$ docker container run â€¦ --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,<span class="hljs-built_in">source</span>=<span class="hljs-string">&quot;<span class="hljs-subst">$(pwd)</span>&quot;</span>,target=/myapp<br><br><span class="hljs-comment"># Docker compose</span><br>volumes:<br>  - <span class="hljs-built_in">type</span>: <span class="hljs-string">&quot;bind&quot;</span><br>    <span class="hljs-built_in">source</span>: <span class="hljs-string">&quot;.&quot;</span><br>    target: <span class="hljs-string">&quot;/myapp&quot;</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #18</strong>: Connect to a Service Running on Docker Host</p>
<blockquote>
<p>Implementation of connecting to Docker host over a custom network with a static IP address.</p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># Create a custom bridge Docker network</span><br>ubuntu <span class="hljs-keyword">in</span> ~ at <span class="hljs-number">3</span>BPlus<br>âœ docker network create -d bridge --subnet <span class="hljs-number">192.168</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">24</span> --gateway <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span> mynet<br><span class="hljs-number">0330</span>b879fcc8fb23eeb092cb66fd86f1796e7f0abe37df4978903cf8fd07217b<br><br>ubuntu <span class="hljs-keyword">in</span> ~ at <span class="hljs-number">3</span>BPlus<br>âœ ifconfig<br>br-<span class="hljs-number">0330</span>b879fcc8: flags=<span class="hljs-number">4099</span>&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span class="hljs-number">1500</span><br>        inet <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span>  netmask <span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>  broadcast <span class="hljs-number">192.168</span>.<span class="hljs-number">0.255</span><br>        ether <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:<span class="hljs-number">16</span>:<span class="hljs-number">0</span>c:c0:<span class="hljs-number">51</span>  txqueuelen <span class="hljs-number">0</span>  (Ethernet)<br>        RX packets <span class="hljs-number">0</span>  bytes <span class="hljs-number">0</span> (<span class="hljs-number">0.0</span> B)<br>        RX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        TX packets <span class="hljs-number">0</span>  bytes <span class="hljs-number">0</span> (<span class="hljs-number">0.0</span> B)<br>        TX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br><span class="hljs-comment"># Start the Alpine container and drop into a Shell prompt.</span><br>ubuntu <span class="hljs-keyword">in</span> ~ at <span class="hljs-number">3</span>BPlus<br>âœ docker container run --rm -it alpine sh<br><br><span class="hljs-comment"># Install the ping utility.</span><br>/ <span class="hljs-comment"># apk update &amp;&amp; apk add iputils</span><br>fetch https:<span class="hljs-regexp">//</span>dl-cdn.alpinelinux.org<span class="hljs-regexp">/alpine/</span>v3.<span class="hljs-number">14</span><span class="hljs-regexp">/main/</span>aarch64/APKINDEX.tar.gz<br>fetch https:<span class="hljs-regexp">//</span>dl-cdn.alpinelinux.org<span class="hljs-regexp">/alpine/</span>v3.<span class="hljs-number">14</span><span class="hljs-regexp">/community/</span>aarch64/APKINDEX.tar.gz<br>v3.<span class="hljs-number">14.2</span>-<span class="hljs-number">5</span>-gd4163d4c6c [https:<span class="hljs-regexp">//</span>dl-cdn.alpinelinux.org<span class="hljs-regexp">/alpine/</span>v3.<span class="hljs-number">14</span>/main]<br>v3.<span class="hljs-number">14.2</span>-<span class="hljs-number">4</span>-ga15b4dc067 [https:<span class="hljs-regexp">//</span>dl-cdn.alpinelinux.org<span class="hljs-regexp">/alpine/</span>v3.<span class="hljs-number">14</span>/community]<br>OK: <span class="hljs-number">14810</span> distinct packages available<br>(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>) Installing libcap (<span class="hljs-number">2.50</span>-r0)<br>(<span class="hljs-number">2</span>/<span class="hljs-number">2</span>) Installing iputils (<span class="hljs-number">20210202</span>-r0)<br>Executing busybox-<span class="hljs-number">1.33</span>.<span class="hljs-number">1</span>-r3.trigger<br>OK: <span class="hljs-number">6</span> MiB <span class="hljs-keyword">in</span> <span class="hljs-number">16</span> packages<br><br><span class="hljs-comment"># Ping the custom IP address we set up.</span><br>/ <span class="hljs-comment"># ping 192.168.0.1</span><br><br><span class="hljs-comment"># You should see this output (hit CTRL+C to stop it)</span><br>PING <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span> (<span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span>) <span class="hljs-number">56</span>(<span class="hljs-number">84</span>) bytes of data.<br><span class="hljs-number">64</span> bytes from <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span>: icmp_seq=<span class="hljs-number">1</span> ttl=<span class="hljs-number">64</span> time=<span class="hljs-number">0.336</span> ms<br><span class="hljs-number">64</span> bytes from <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span>: icmp_seq=<span class="hljs-number">2</span> ttl=<span class="hljs-number">64</span> time=<span class="hljs-number">0.293</span> ms<br>^C<br>--- <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span> ping statistics ---<br><span class="hljs-number">2</span> packets transmitted, <span class="hljs-number">2</span> received, <span class="hljs-number">0</span>% packet loss, time <span class="hljs-number">1013</span>ms<br>rtt min<span class="hljs-regexp">/avg/m</span>ax<span class="hljs-regexp">/mdev = 0.293/</span><span class="hljs-number">0.314</span><span class="hljs-regexp">/0.336/</span><span class="hljs-number">0.021</span> ms<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #19</strong>: Show Total Disk Space Used by Docker</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs tap">ubuntu in ~ at 3BPlus<br>âœ docker system df<br>TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE<br>Images         <span class="hljs-number"> 3 </span>       <span class="hljs-number"> 2 </span>        203.9MB   198.5MB (97%)<br>Containers     <span class="hljs-number"> 3 </span>       <span class="hljs-number"> 1 </span>        2.524MB   0B (0%)<br>Local Volumes  <span class="hljs-number"> 1 </span>       <span class="hljs-number"> 0 </span>        0B        0B<br>Build Cache    <span class="hljs-number"> 0 </span>       <span class="hljs-number"> 0 </span>        0B        0B<br><br><span class="hljs-comment"># -v flag (verbose) - will show the unique image size for each image</span><br>ubuntu in ~ at 3BPlus<br>âœ docker system df -v<br>Images space usage:<br><br>REPOSITORY            TAG       IMAGE ID       CREATED       SIZE      SHARED SIZE   UNIQUE SIZE   CONTAINERS<br>alpine                latest    bb3de5531c18  <span class="hljs-number"> 4 </span>days ago    5.337MB   0B            5.337MB       2<br>hello-world           latest    bc11b176a293  <span class="hljs-number"> 7 </span>weeks ago   9.136kB   0B            9.136kB       1<br>bahamat/unix-1st-ed   latest    37aa142d2113  <span class="hljs-number"> 5 </span>years ago   198.5MB   0B            198.5MB       0<br><br>Containers space usage:<br><br>CONTAINER ID   IMAGE         COMMAND            LOCAL VOLUMES   SIZE      CREATED       STATUS                   NAMES<br>9023720cdee7   alpine        &quot;sh&quot;              <span class="hljs-number"> 0 </span>              2.52MB   <span class="hljs-number"> 5 </span>hours ago   Up<span class="hljs-number"> 5 </span>hours               upbeat_kepler<br>9e272ab58362   alpine        &quot;sh -c &#x27;exit 1&#x27;&quot;  <span class="hljs-number"> 0 </span>              0B       <span class="hljs-number"> 6 </span>hours ago   Exited (1)<span class="hljs-number"> 6 </span>hours ago   naughty_blackburn<br>d95cc7e19d43   hello-world   &quot;/hello&quot;          <span class="hljs-number"> 0 </span>              0B       <span class="hljs-number"> 7 </span>weeks ago   Exited (0)<span class="hljs-number"> 7 </span>weeks ago   nifty_hellman<br><br>Local Volumes space usage:<br><br>VOLUME NAME   LINKS     SIZE<br>user_my-db   <span class="hljs-number"> 0 </span>        0B<br><br>Build cache usage: 0B<br><br>CACHE ID   CACHE TYPE   SIZE      CREATED   LAST USED   USAGE     SHARED<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #20</strong>: Docker Compose Stop vs Down</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-comment"># docker-compose stop</span><br>&gt; stop container, <span class="hljs-keyword">but</span> <span class="hljs-keyword">it</span> won&#x27;t remove them<br><br><span class="hljs-comment"># docker-compose down</span><br>&gt; stop container, removes <span class="hljs-keyword">the</span> stopped containers <span class="hljs-keyword">as</span> well <span class="hljs-keyword">as</span> any networks <span class="hljs-keyword">that</span> were created.<br><br><span class="hljs-comment"># docker-compose down -v</span><br>&gt; add remove all volumes too.<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #21</strong>: Difference between Docker Create, Start and Run</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-comment"># Create:</span><br>  adds a writeable container <span class="hljs-keyword">on</span> top <span class="hljs-keyword">of</span> your image <span class="hljs-keyword">and</span> sets <span class="hljs-keyword">it</span> up <span class="hljs-keyword">for</span> <span class="hljs-built_in">running</span> whatever command you specified <span class="hljs-keyword">in</span> you CMD. The container ID <span class="hljs-keyword">is</span> reported <span class="hljs-keyword">back</span> <span class="hljs-keyword">but</span> <span class="hljs-keyword">it</span>&#x27;s <span class="hljs-keyword">not</span> started.<br><br><span class="hljs-comment"># Start:</span><br>  will start any stopped container.<br><br><span class="hljs-comment"># Run:</span><br>  combination <span class="hljs-keyword">of</span> create <span class="hljs-keyword">and</span> start, It creates <span class="hljs-keyword">the</span> container <span class="hljs-keyword">and</span> starts <span class="hljs-keyword">it</span>.<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #22</strong>: Docker Mem Limit</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">é»˜è®¤æƒ…å†µä¸‹å®¹å™¨ä½¿ç”¨çš„èµ„æºä¸å—é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸»æœºå†…æ ¸è°ƒåº¦å™¨æ‰€å…è®¸çš„æœ€å¤§èµ„æº</span><br><span class="hljs-meta">&gt;</span> <span class="javascript">é™åˆ¶å®¹å™¨ä¸èƒ½è¿‡å¤šçš„ä½¿ç”¨ä¸»æœºçš„å†…å­˜ï¼Œä¸€æ—¦å†…å­˜æ£€æµ‹åˆ°æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ä»¥åˆ†é…ï¼Œå°±ä¼šå‡ºç°OOM(Out Of Memory Exception). å¹¶å¼€å§‹éšæœºKillä¸€äº›è¿›ç¨‹ç”¨äºé‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œdockerå°è¯•è°ƒæ•´docker daemon çš„OOMä¼˜å…ˆçº§è¿›è¡Œç¼“è§£ï¼Œå†…æ ¸åœ¨é€‰æ‹©æ€æ­»çš„è¿›ç¨‹æ—¶ä¼šå¯¹æ‰€æœ‰çš„è¿›ç¨‹æ‰“åˆ†ï¼Œç›´æ¥æ€æ­»å¾—åˆ†æœ€é«˜çš„è¿›ç¨‹ï¼Œdocker daemonçš„OOMä¼˜å…ˆçº§è¢«é™ä½</span><br></code></pre></td></tr></table></figure>
<ul>
<li><a href="/misc/code/script/show_process_score.sh">show_process_score.sh</a><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># è„šæœ¬è¾“å‡ºå¾—åˆ†æœ€é«˜çš„10ä¸ªè¿›ç¨‹,å¹¶æ’åº</span><br>  âœ ./show_process_score.sh<br>  <span class="hljs-number">672</span>  <span class="hljs-number">1510</span> <span class="hljs-regexp">/usr/</span>bin/gnome-shell<br>  <span class="hljs-number">669</span>  <span class="hljs-number">1811</span> <span class="hljs-regexp">/usr/</span>libexec/gnome-initial-setup --existing-user<br>  <span class="hljs-number">668</span>  <span class="hljs-number">1010</span> <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/xorg/</span>Xorg vt2 -displayfd <span class="hljs-number">3</span> -auth <span class="hljs-regexp">/run/u</span>se<br>  <span class="hljs-number">667</span>  <span class="hljs-number">2062</span> update-notifier<br>  <span class="hljs-number">667</span>  <span class="hljs-number">1760</span> <span class="hljs-regexp">/usr/</span>libexec<span class="hljs-regexp">/evolution-data-server/</span>evolution-alarm<br>  <span class="hljs-number">667</span>  <span class="hljs-number">1128</span> <span class="hljs-regexp">/usr/</span>libexec/goa-daemon<br>  <span class="hljs-number">666</span>   <span class="hljs-number">996</span> <span class="hljs-regexp">/usr/</span>libexec/tracker-miner-fs<br>  <span class="hljs-number">666</span>   <span class="hljs-number">994</span> <span class="hljs-regexp">/usr/</span>bin/pulseaudio --daemonize=no --log-target=jo<br>  <span class="hljs-number">666</span>   <span class="hljs-number">988</span> (sd-pam)<br>  <span class="hljs-number">666</span>   <span class="hljs-number">987</span> <span class="hljs-regexp">/lib/</span>systemd/systemd --user<br><br><span class="hljs-comment"># é™ä½OOMé£é™©:</span><br>  - é€šè¿‡æµ‹è¯•æŒæ¡åº”ç”¨å¯¹å†…å­˜çš„éœ€æ±‚<br>  - ä¿è¯è¿è¡Œå®¹å™¨çš„ä¸»æœºæœ‰å……è¶³çš„å†…å­˜<br>  - é™åˆ¶å®¹å™¨å¯ä»¥ä½¿ç”¨çš„å†…å­˜<br>  - ä¸ºä¸»æœºé…ç½®Swap<br><br></code></pre></td></tr></table></figure></li>
<li>å‹åŠ›æµ‹è¯•å·¥å…· stress<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-comment"># stress</span><br>&gt; a tool for generating workload. <span class="hljs-keyword">It</span> can produce CPU, memory, I/O, <span class="hljs-keyword">and</span> disk stress.<br></code></pre></td></tr></table></figure></li>
<li><a href="/misc/code/devops/benchmark/stress.Dockerfile">stress.Dockerfile</a><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs tap"><span class="hljs-comment"># åˆ›å»ºé•œåƒ</span><br>âœ docker build -f stress.Dockerfile -t chyiyaqing/u-stress:latest .<br><br><span class="hljs-comment"># é™åˆ¶å†…å­˜ä½¿ç”¨ä¸Šé™(memory-swapå€¼åŒ…å«å®¹å™¨å¯ç”¨å†…å­˜å’Œå¯ç”¨swap;)</span><br>âœ docker run -it -m 300M --memory-swap -1 --name con1 chyiyaqing/u-stress /bin/bash<br>root@1a3df043e956:/<span class="hljs-comment"># stress --vm 1 --vm-bytes 500M</span><br>stress: info: [9] dispatching hogs:<span class="hljs-number"> 0 </span>cpu,<span class="hljs-number"> 0 </span>io,<span class="hljs-number"> 1 </span>vm,<span class="hljs-number"> 0 </span>hdd<br><br><span class="hljs-comment"># docker stats æŸ¥çœ‹</span><br>$ docker stats<br>CONTAINER ID   NAME      CPU %     MEM USAGE / LIMIT   MEM %     NET I/O       BLOCK I/O     PIDS<br>1a3df043e956   con1      71.85%    300MiB / 300MiB     100.00%   6.71kB / 0B   3.45GB / 0B   3<br><br><span class="hljs-comment"># Topå‘½ä»¤æŸ¥çœ‹stressè¿›ç¨‹å†…å­˜å®é™…æƒ…å†µ</span><br>chyiyaqing in ~ at chyiyaqing-PowerEdge-R720 took 5s<br><span class="hljs-comment"># pgrep å‘½ä»¤æŸ¥è¯¢stresså‘½ä»¤ç›¸å…³è¿›ç¨‹</span><br>âœ pgrep stress<br>48622<br>48623<br><br>chyiyaqing in ~ at chyiyaqing-PowerEdge-R720<br>âœ top -p 48623<br>top - 22:40:23 up<span class="hljs-number"> 2 </span>days,  5:40, <span class="hljs-number"> 4 </span>users,  load average: 0.95, 0.47, 0.18<br>Tasks:  <span class="hljs-number"> 1 </span>total,  <span class="hljs-number"> 1 </span>running,  <span class="hljs-number"> 0 </span>sleeping,  <span class="hljs-number"> 0 </span>stopped,  <span class="hljs-number"> 0 </span>zombie<br>%Cpu(s):  0.1 us,  2.0 sy,  0.0 ni, 97.1 id,  0.8 wa,  0.0 hi,  0.0 si,  0.0 st<br>MiB Mem :  32106.2 total,  27283.4 free,   1420.6 used,   3402.2 buff/cache<br>MiB Swap:   2048.0 total,   1545.3 free,    502.7 used.  30224.1 avail Mem<br><br>    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND<br> <span class="hljs-number"> 48623 </span>root     <span class="hljs-number"> 20 </span> <span class="hljs-number"> 0 </span><span class="hljs-number"> 515868 </span>305460   <span class="hljs-number"> 272 </span>R  71.7   0.9   2:02.53 stress<br><br><span class="hljs-comment"># VIRT è¿›ç¨‹è™šæ‹Ÿå†…å­˜å¤§å°; RES å®é™…åˆ†é…ç‰©ç†å†…å­˜å¤§å°</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Docker Tip #23</strong>: Docker CPU Limit</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs vim">&gt; é»˜è®¤æƒ…å†µä¸‹å®¹å™¨å¯ä»¥ä¸å—é™åˆ¶çš„ä½¿ç”¨CPU/å†…å­˜èµ„æº, å¦‚æœä¸å¯¹å®¹å™¨ä½¿ç”¨è¿›è¡Œé™åˆ¶ï¼Œä¸€æ—¦å‘ç”Ÿå®¹å™¨ç¨‹åºå¼‚å¸¸ä½¿ç”¨CPU/Memæƒ…å†µï¼Œå¯èƒ½ä¼šæŠŠæ•´ä¸ªä¸»æœºCPU/Memèµ„æºè€—å°½.<br><br># é™åˆ¶å¯ç”¨CPUä¸ªæ•°<br>âœ docker run --rm -it --cpus=<span class="hljs-number">2</span> chyiyaqing/<span class="hljs-keyword">u</span>-stress /bin/bash<br><br>root@f11127fe7c50:/# stress -<span class="hljs-keyword">c</span> <span class="hljs-number">4</span><br>stres<span class="hljs-variable">s:</span> info: [<span class="hljs-number">9</span>] dispatching hog<span class="hljs-variable">s:</span> <span class="hljs-number">4</span> cpu, <span class="hljs-number">0</span> io, <span class="hljs-number">0</span> <span class="hljs-keyword">vm</span>, <span class="hljs-number">0</span> hdd<br><br># docker stats<br>CONTAINER ID   NAME                CPU %     MEM USAGE / LIMIT     MEM %     NET I/O       BLOCK I/O   PIDS<br>f11127fe7c50   competent_noether   <span class="hljs-number">198.98</span>%   <span class="hljs-number">1.695</span>MiB / <span class="hljs-number">31.35</span>GiB   <span class="hljs-number">0.01</span>%     <span class="hljs-number">39.7</span>kB / <span class="hljs-number">0</span>B   <span class="hljs-number">0</span>B / <span class="hljs-number">0</span>B     <span class="hljs-number">6</span><br><br># Top<br>Task<span class="hljs-variable">s:</span> <span class="hljs-number">468</span> total,   <span class="hljs-number">5</span> running, <span class="hljs-number">463</span> sleeping,   <span class="hljs-number">0</span> stopped,   <span class="hljs-number">0</span> zombie<br>%Cpu0  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu1  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu2  : <span class="hljs-number">50.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">50.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span>     --<br>%Cpu3  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu4  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu5  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu6  :  <span class="hljs-number">5.0</span> us,  <span class="hljs-number">5.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">90.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu7  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu8  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu9  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu10 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu11 : <span class="hljs-number">50.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">50.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span>     --<br>%Cpu12 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu13 : <span class="hljs-number">47.4</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">52.6</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span>     --<br>%Cpu14 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu15 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu16 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu17 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu18 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu19 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu20 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu21 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu22 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu23 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu24 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu25 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu26 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu27 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu28 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu29 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu30 :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu31 : <span class="hljs-number">50.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">50.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span>     --<br>MiB Mem :  <span class="hljs-number">32106.2</span> total,  <span class="hljs-number">27901.2</span> free,   <span class="hljs-number">1119.0</span> used,   <span class="hljs-number">3086.0</span> buff/cache<br>MiB Swap:   <span class="hljs-number">2048.0</span> total,   <span class="hljs-number">2044.6</span> free,      <span class="hljs-number">3.4</span> used.  <span class="hljs-number">30537.0</span> avail Mem<br><br>æŸ¥çœ‹TopçœŸå®æƒ…å†µä¸æ˜¯ä¸¤ä¸ªCPUè´Ÿè½½<span class="hljs-number">100</span>%, è€Œæ˜¯å®¹å™¨æ¶ˆè€—CPUæ€»å…±<span class="hljs-number">200</span>%çš„è´Ÿè½½ï¼Œè¿›ç¨‹æ²¡æœ‰CPUæ•°çš„é™åˆ¶ï¼Œåªèƒ½é€šè¿‡è¿›ç¨‹æ¶ˆè€—CPUæ—¶é—´ç‰‡ç»Ÿè®¡å‡ºè¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”<br><br># æŒ‡å®šå›ºå®šCPU<br>  &gt; é€šè¿‡--cpuset-cpusè®¾ç½®å®¹å™¨è¿è¡Œåœ¨å‡ ä¸ªå›ºå®šçš„CPUä¸Š, å› ä¸ºå¤šæ ¸ç³»ç»Ÿæ¯ä¸ªæ ¸å¿ƒéƒ½æœ‰è‡ªå·±çš„ç¼“å­˜,é¢‘ç¹çš„è°ƒåº¦è¿›ç¨‹åœ¨ä¸åŒçš„æ ¸å¿ƒä¸Šæ‰§è¡Œä¼šå¸¦æ¥ç¼“å­˜å¤±æ•ˆçš„å¼€é”€<br>  chyiyaqing in ~ at chyiyaqing-PowerEdge-R720<br>  âœ docker run --rm -it --cpuset-cpus=<span class="hljs-string">&quot;0,1,2,3&quot;</span> chyiyaqing/<span class="hljs-keyword">u</span>-stress /bin/bash<br><br># å¯åŠ¨å¡”é‡Œæµ‹è¯•å‘½ä»¤<br>root@<span class="hljs-number">95110</span>b6915af:/# stress -<span class="hljs-keyword">c</span> <span class="hljs-number">10</span><br>stres<span class="hljs-variable">s:</span> info: [<span class="hljs-number">12</span>] dispatching hog<span class="hljs-variable">s:</span> <span class="hljs-number">4</span> cpu, <span class="hljs-number">0</span> io, <span class="hljs-number">0</span> <span class="hljs-keyword">vm</span>, <span class="hljs-number">0</span> hdd<br><br># docker stats<br>CONTAINER ID   NAME                 CPU %     MEM USAGE / LIMIT    MEM %     NET I/O      BLOCK I/O   PIDS<br><span class="hljs-number">39</span>b4ce536148   frosty_stonebraker   <span class="hljs-number">399.38</span>%   <span class="hljs-number">2.43</span>MiB / <span class="hljs-number">31.35</span>GiB   <span class="hljs-number">0.01</span>%     <span class="hljs-number">3.9</span>kB / <span class="hljs-number">0</span>B   <span class="hljs-number">0</span>B / <span class="hljs-number">0</span>B     <span class="hljs-number">12</span><br><br># Top<br>âœ top<br>top - <span class="hljs-number">23</span>:<span class="hljs-number">08</span>:<span class="hljs-number">19</span> <span class="hljs-keyword">up</span> <span class="hljs-number">2</span> days,  <span class="hljs-number">6</span>:<span class="hljs-number">08</span>,  <span class="hljs-number">4</span> users,  load average: <span class="hljs-number">6.97</span>, <span class="hljs-number">3.73</span>, <span class="hljs-number">2.01</span><br>Task<span class="hljs-variable">s:</span> <span class="hljs-number">496</span> total,  <span class="hljs-number">11</span> running, <span class="hljs-number">485</span> sleeping,   <span class="hljs-number">0</span> stopped,   <span class="hljs-number">0</span> zombie<br>%Cpu0  :<span class="hljs-number">100.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,  <span class="hljs-number">0.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu1  :<span class="hljs-number">100.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,  <span class="hljs-number">0.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu2  :<span class="hljs-number">100.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,  <span class="hljs-number">0.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu3  :<span class="hljs-number">100.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,  <span class="hljs-number">0.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu4  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni, <span class="hljs-number">97.7</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">2.3</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br><br># è®¾ç½®CPUçš„æƒé‡<br>&gt; è®¾ç½®CPUæƒé‡åªæœ‰åœ¨å®¹å™¨äº‰ç”¨CPUèµ„æºçš„æƒ…å†µä¸‹ï¼ŒCPUçš„æƒé‡æ‰èƒ½è®©ä¸åŒçš„å®¹å™¨åˆ†åˆ°ä¸åŒçš„CPUç”¨é‡ --cpu-shares è®¾ç½®CPUæƒé‡ï¼Œé»˜è®¤å€¼ä¸º<span class="hljs-number">1024</span>,<br><br># è¿è¡Œä¸¤ä¸ªå®¹å™¨ï¼ŒæŒ‡å®šä½¿ç”¨CPU0ï¼Œåˆ†åˆ«è®¾ç½®--cpu-shares <span class="hljs-number">512</span>,<span class="hljs-number">1024</span><br>  âœ docker run --rm -it --cpuset-cpus=<span class="hljs-string">&quot;0&quot;</span> --cpu-shares=<span class="hljs-number">512</span> chyiyaqing/<span class="hljs-keyword">u</span>-stress /bin/bash<br>  âœ docker run --rm -it --cpuset-cpus=<span class="hljs-string">&quot;0&quot;</span> --cpu-shares=<span class="hljs-number">1024</span> chyiyaqing/<span class="hljs-keyword">u</span>-stress /bin/bash<br><br># ä¸¤ä¸ªå®¹å™¨éƒ½è¿è¡Œstress -<span class="hljs-keyword">c</span> <span class="hljs-number">4</span><br><br># top<br>âœ top<br>top - <span class="hljs-number">23</span>:<span class="hljs-number">14</span>:<span class="hljs-number">14</span> <span class="hljs-keyword">up</span> <span class="hljs-number">2</span> days,  <span class="hljs-number">6</span>:<span class="hljs-number">14</span>,  <span class="hljs-number">5</span> users,  load average: <span class="hljs-number">5.30</span>, <span class="hljs-number">5.25</span>, <span class="hljs-number">3.42</span><br>Task<span class="hljs-variable">s:</span> <span class="hljs-number">495</span> total,   <span class="hljs-number">9</span> running, <span class="hljs-number">486</span> sleeping,   <span class="hljs-number">0</span> stopped,   <span class="hljs-number">0</span> zombie<br>%Cpu0  :<span class="hljs-number">100.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,  <span class="hljs-number">0.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br>%Cpu1  :  <span class="hljs-number">0.0</span> us,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">sy</span>,  <span class="hljs-number">0.0</span> ni,<span class="hljs-number">100.0</span> id,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">wa</span>,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">hi</span>,  <span class="hljs-number">0.0</span> si,  <span class="hljs-number">0.0</span> <span class="hljs-keyword">st</span><br><br># docker stats<br>CONTAINER ID   NAME                CPU %     MEM USAGE / LIMIT     MEM %     NET I/O       BLOCK I/O   PIDS<br>f9c8864fab87   beautiful_neumann   <span class="hljs-number">66.39</span>%    <span class="hljs-number">1.695</span>MiB / <span class="hljs-number">31.35</span>GiB   <span class="hljs-number">0.01</span>%     <span class="hljs-number">5.23</span>kB / <span class="hljs-number">0</span>B   <span class="hljs-number">0</span>B / <span class="hljs-number">0</span>B     <span class="hljs-number">6</span><br><span class="hljs-number">6</span>b69afc7fea5   pensive_vaughan     <span class="hljs-number">33.41</span>%    <span class="hljs-number">1.676</span>MiB / <span class="hljs-number">31.35</span>GiB   <span class="hljs-number">0.01</span>%     <span class="hljs-number">7.17</span>kB / <span class="hljs-number">0</span>B   <span class="hljs-number">0</span>B / <span class="hljs-number">0</span>B     <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #24</strong>: Docker import/export vs. load/save</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">âœ docker --help | grep -E <span class="hljs-string">&quot;(export|import|load|save)&quot;</span><br>export      Export a container<span class="hljs-comment">&#x27;s filesystem as a tar archive</span><br>import      Import the contents <span class="hljs-keyword">from</span> a tarball <span class="hljs-keyword">to</span> create a filesystem image<br>load        Load an image <span class="hljs-keyword">from</span> a tar archive <span class="hljs-built_in">or</span> STDIN<br>save        Save one <span class="hljs-built_in">or</span> more images <span class="hljs-keyword">to</span> a tar archive (streamed <span class="hljs-keyword">to</span> STDOUT <span class="hljs-keyword">by</span> <span class="hljs-keyword">default</span>)<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #25</strong>: Dockerç½‘ç»œæ¨¡å¼</p>
<table>
<thead>
<tr>
<th align="left">Docker ç½‘ç»œæ¨¡å¼</th>
<th align="left">é…ç½®</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">hostæ¨¡å¼</td>
<td align="left">-net=host</td>
<td align="left">å®¹å™¨å’Œå®¿ä¸»æœºå…±äº«Network namespace</td>
</tr>
<tr>
<td align="left">container æ¨¡å¼</td>
<td align="left">-net=container:NAME_or_ID</td>
<td align="left">å®¹å™¨ä¸å¦å¤–ä¸€ä¸ªå®¹å™¨å…±äº«Network namespace, kubernetesä¸­çš„podå°±æ˜¯å¤šä¸ªå®¹å™¨å…±äº«ä¸€ä¸ªNetwork namespace</td>
</tr>
<tr>
<td align="left">noneæ¨¡å¼</td>
<td align="left">-net=none</td>
<td align="left">å®¹å™¨æœ‰ç‹¬ç«‹çš„Network namespace,ä½†å¹¶æ²¡æœ‰å¯¹å…¶è¿›è¡Œä»»ä½•ç½‘ç»œè®¾ç½®</td>
</tr>
<tr>
<td align="left">bridgeæ¨¡å¼</td>
<td align="left">-net=bridge</td>
<td align="left">é»˜è®¤ä¸ºè¯¥æ¨¡å¼</td>
</tr>
</tbody></table>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"># å®ç°åŸç†<br>  &gt; å®¿ä¸»æœºè™šæ‹Ÿä¸€ä¸ª<span class="hljs-selector-tag">Docker</span>å®¹å™¨ç½‘æ¡¥(docker0), <span class="hljs-selector-tag">Docker</span>å¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶ä¼šæ ¹æ®<span class="hljs-selector-tag">Docker</span>ç½‘æ¡¥(docker0)çš„ç½‘æ®µåˆ†é…ç»™å®¹å™¨ä¸€ä¸ª<span class="hljs-selector-tag">IP</span>åœ°å€ï¼Œç§°ä¸º<span class="hljs-selector-tag">Container-IP</span>,åŒæ—¶<span class="hljs-selector-tag">Docker</span>ç½‘æ¡¥æ˜¯æ¯ä¸ªå®¹å™¨çš„é»˜è®¤ç½‘å…³.å› ä¸ºåŒä¸€å®¿ä¸»æœºå†…çš„å®¹å™¨éƒ½æ¥å…¥åŒä¸€ç½‘æ¡¥ï¼Œè¿™æ ·å®¹å™¨ä¹‹é—´å°±èƒ½å¤Ÿé€šè¿‡å®¹å™¨çš„<span class="hljs-selector-tag">Container-IP</span>ç›´æ¥é€šä¿¡.<br>  &gt; <span class="hljs-selector-tag">Docker</span>ç½‘æ¡¥æ˜¯å®¿ä¸»ä¸»æœºè™šæ‹Ÿå‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯çœŸæ˜¯å­˜åœ¨çš„ç½‘ç»œè®¾å¤‡ï¼Œå¤–éƒ¨ç½‘ç»œæ˜¯æ— æ³•å¯»å€åˆ°ï¼Œå¦‚æœå®¹å™¨å¸Œæœ›å¤–éƒ¨èƒ½å¤Ÿè®¿é—®åˆ°ï¼Œå¯ä»¥é€šè¿‡æ˜ å°„å®¹å™¨ç«¯å£åˆ°å®¿ä¸»ä¸»æœº(ç«¯å£æ˜ å°„),è®¿é—®å®¹å™¨çš„æ—¶å€™å°±é€šè¿‡<span class="hljs-selector-attr">[å®¿ä¸»ä¸»æœºIP]</span>:<span class="hljs-selector-attr">[å®¹å™¨ç«¯å£]</span>è®¿é—®å®¹å™¨<br><br></code></pre></td></tr></table></figure>
<ul>
<li>hostæ¨¡å¼<br><img src="/misc/images/docker-network-host.png" srcset="/img/loading.gif" lazyload alt="Hostæ¨¡å¼"><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">å®¹å™¨ä½¿ç”¨hostæ¨¡å¼å°†ä½¿ç”¨å®¿ä¸»ä¸»æœºçš„IPå’Œç«¯å£,å®¹å™¨çš„å…¶ä»–æ–¹é¢ï¼Œæ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨è¿˜æ˜¯å’Œå®¿ä¸»ä¸»æœºéš”ç¦»</span><br><span class="hljs-meta">&gt;</span> <span class="javascript">ä½¿ç”¨hostæ¨¡å¼çš„å®¹å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨å®¿ä¸»ä¸»æœºçš„IPåœ°å€ä¸å¤–ç•Œé€šä¿¡ï¼Œå®¹å™¨å†…éƒ¨çš„æœåŠ¡ç«¯å£ä¹Ÿå¯ä»¥ä½¿ç”¨å®¿ä¸»ä¸»æœºçš„ç«¯å£ï¼Œä¸éœ€è¦è¿›è¡ŒNATï¼Œhostæœ€å¤§ä¼˜åŠ¿æ˜¯ç½‘ç»œæ€§èƒ½æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯docker hostä¸Šå·²ç»ä½¿ç”¨çš„ç«¯å£å°±ä¸èƒ½å†ä½¿ç”¨,ç½‘ç»œéš”ç¦»å‹ä¸å¥½</span><br></code></pre></td></tr></table></figure></li>
<li>containeræ¨¡å¼<br><img src="/misc/images/docker-network-container.png" srcset="/img/loading.gif" lazyload alt="Containeræ¨¡å¼"><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">&gt; æ–°åˆ›å»ºçš„å®¹å™¨å’Œå·²ç»å­˜åœ¨çš„ä¸€ä¸ªå®¹å™¨å…±äº«ä¸€ä¸ªNetwork Namespace.æ–°åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„<span class="hljs-built_in">IP</span>ï¼Œè€Œæ˜¯å’ŒæŒ‡å®šçš„å®¹å™¨å…±äº«<span class="hljs-built_in">IP</span>å’Œç«¯å£èŒƒå›´, ä¸¤ä¸ªå®¹å™¨çš„è¿›ç¨‹å¯ä»¥é€šè¿‡loç½‘å¡è®¾å¤‡é€šä¿¡<br></code></pre></td></tr></table></figure></li>
<li>noneæ¨¡å¼<br><img src="/misc/images/docker-network-none.png" srcset="/img/loading.gif" lazyload alt="Noneæ¨¡å¼"><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fortran">&gt; <span class="hljs-keyword">None</span>æ¨¡å¼,Dockerå®¹å™¨æ‹¥æœ‰è‡ªå·±çš„Network Namespace,ä½†æ˜¯ï¼Œå¹¶ä¸ä¸ºDockerå®¹å™¨è¿›è¡Œä»»ä½•ç½‘ç»œé…ç½®ï¼ŒDockerå®¹å™¨æ²¡æœ‰ç½‘å¡ã€IPã€è·¯ç”±,éœ€è¦è‡ªå·±å¯¹Dockerå®¹å™¨æ·»åŠ ç½‘å¡ã€é…ç½®IP<br>&gt; <span class="hljs-keyword">None</span>æ¨¡å¼ä¸‹åªæœ‰loå›ç¯ç½‘ç»œï¼Œæ²¡æœ‰å…¶ä»–ç½‘å¡ï¼Œ<span class="hljs-keyword">None</span>æ¨¡å¼å¯ä»¥åœ¨å®¹å™¨åˆ›å»ºæ—¶é€šè¿‡network=<span class="hljs-keyword">None</span>æŒ‡å®šï¼Œè¿™ç±»ç½‘ç»œæ²¡åŠæ³•è”ç½‘ï¼Œå°é—­çš„ç½‘ç»œèƒ½å¾ˆå¥½çš„ä¿è¯å®¹å™¨çš„å®‰å…¨<br></code></pre></td></tr></table></figure></li>
<li>bridgeæ¨¡å¼<br><img src="/misc/images/docker-network-bridge.png" srcset="/img/loading.gif" lazyload alt="Bridgeæ¨¡å¼"><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta">&gt;</span> <span class="javascript">bridgeæ¨¡å¼æ˜¯dockeré»˜è®¤ç½‘ç»œæ¨¡å¼,ä¸å†™--netå‚æ•°å°±æ˜¯bridgeæ¨¡å¼</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Docker Tip #26</strong>: Alphine Linux Dockerfile</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit">chyiyaqing in core at chyiyaqing-PowerEdge-R720 on î‚  feat/adaptation-kingbases [!?] via ğŸ¹ v1.17.1 on ğŸ³ v20.10.10<br>âœ docker run core:BF<span class="hljs-string">-9748</span><br><span class="hljs-keyword">Error </span>relocating /root/core/blocface-core: __vfprintf_chk: symbol not found<br><span class="hljs-keyword">Error </span>relocating /root/core/blocface-core: __fprintf_chk: symbol not found<br><br>åœ¨Alpine Linuxä¸Š, not foundé”™è¯¯æ˜¯åŠ¨æ€é“¾æ¥å¤±è´¥çš„å…¸å‹ç‰¹å¾ï¼Œmuslçš„lddé“¾æ¥å™¨å­˜åœ¨ä¸€ä¸ªç›¸å½“æ··ä¹±çš„é”™è¯¯ï¼Œå¤§å¤šæ•°Linuxè½¯ä»¶éƒ½æ˜¯ä¸glibc(GNUlibcåº“)ç›¸é“¾æ¥(libcæä¾›äº†æ ‡å‡†çš„Cåº“å’Œposixapi),å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆæœ¬éƒ½æ˜¯åŸºäºglibc, alpineLinuxæ˜¯åŸºäºmuslibcåº“(è¿™æ˜¯æœ€å°çš„å®ç°ï¼Œä¸¥æ ¼éµå®ˆPOSIX).<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #27</strong>: é˜²æ­¢å®¹å™¨è‡ªåŠ¨é€€å‡º</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">&gt; dockerå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯åŒå®¹å™¨ä¸­çš„å‰ç½®è¿›ç¨‹ç›¸å…³åœ¨ä¸€èµ·,å‰ç½®è¿›ç¨‹è¿è¡Œç»“æŸåï¼Œå®¹å™¨ä¾¿è‡ªåŠ¨é€€å‡º<br><br>ä¸‹æ–‡ä½¿ç”¨alpineé•œåƒåšä¸ºåŸºç¡€é•œåƒï¼Œåˆ›å»ºä¸€ä¸ªalpineç³»ç»Ÿå°å®¹å™¨,è®©å…¶å¯ä»¥å¸¸é©»è¿è¡Œï¼Œä»¥ä¾¿æˆ‘ä»¬ç™»é™†äº¤äº’æ‰§è¡Œ<br><br>  <span class="hljs-comment"># ä½¿ç”¨alpineç³»ç»Ÿé•œåƒåˆ›å»ºå®¹å™¨</span><br>  <span class="hljs-comment"># -i interactive=true å¼€å¯stdin</span><br>  <span class="hljs-comment"># -t tty=true åˆ†é…ä¼šè¯ç»ˆç«¯</span><br>  <span class="hljs-comment"># -d å®ˆæŠ¤æ¨¡å¼ ä¸åŠ å°±ç›´æ¥è¿›å…¥å®¹å™¨ä¸­éœ€è¦ctrl+p+qåˆ‡å‡ºï¼Œ</span><br><br>  chyiyaqing in ~ at chyiyaqing-PowerEdge-R720 took 9s<br>  âœ docker run -it -d --name my_alpine alpine sh<br>  Unable to find image &#x27;alpine:latest&#x27; locally<br>  latest: Pulling from library/alpine<br>  a0d0a0d46f8b: Pull complete<br>  Digest: sha256:e1c082e3d3c45cccac829840a25941e679c25d438cc8412c2fa221cf1a824e6a<br>  Status: Downloaded newer image for alpine:latest<br>  78c0429dd98fe42addaa2071ffe1ca6c22295ea6d6d465ff1f970644f6234a37<br><br>  <span class="hljs-comment"># my_alpine å®¹å™¨å¤„äºè¿è¡ŒçŠ¶æ€</span><br>  chyiyaqing in ~ at chyiyaqing-PowerEdge-R720 took 8s<br>  âœ docker ps |<span class="hljs-string"> grep alpine</span><br><span class="hljs-string">  78c0429dd98f   alpine                                                          &quot;sh&quot;                     34 seconds ago   Up 34 seconds                                                         my_alpine</span><br><span class="hljs-string"></span><br><span class="hljs-string">  # ç™»å…¥å®¹å™¨</span><br><span class="hljs-string">  chyiyaqing in ~ at chyiyaqing-PowerEdge-R720</span><br><span class="hljs-string">  âœ docker exec -it my_alpine sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">  # æŸ¥çœ‹ sh ä¼šè¯æ•°é‡</span><br><span class="hljs-string">  / # ps</span><br><span class="hljs-string">  PID   USER     TIME  COMMAND</span><br><span class="hljs-string">      1 root      0:00 sh</span><br><span class="hljs-string">      7 root      0:00 sh</span><br><span class="hljs-string">     13 root      0:00 ps</span><br><span class="hljs-string"></span><br><span class="hljs-string">  # alpineä½¿ç”¨apkåšä¸ºåŒ…ç®¡ç†</span><br><span class="hljs-string">  / # apk add sl</span><br><span class="hljs-string">  fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz</span><br><span class="hljs-string">  fetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz</span><br><span class="hljs-string">  (1/3) Installing ncurses-terminfo-base (6.2_p20210612-r0)</span><br><span class="hljs-string">  (2/3) Installing ncurses-libs (6.2_p20210612-r0)</span><br><span class="hljs-string">  (3/3) Installing sl (5.02-r0)</span><br><span class="hljs-string">  Executing busybox-1.33.1-r3.trigger</span><br><span class="hljs-string">  OK: 6 MiB in 17 packages</span><br><span class="hljs-string">  / # sl</span><br><span class="hljs-string">            (@@@@)</span><br><span class="hljs-string"></span><br><span class="hljs-string">          (   )</span><br><span class="hljs-string">        ====        ________                ___________</span><br><span class="hljs-string">    _D _</span>|<span class="hljs-string">  </span>|<span class="hljs-string">_______/        \__I_I_____===__</span>|<span class="hljs-string">_________</span>|<br>     |<span class="hljs-string">(_)---  </span>|<span class="hljs-string">   H\________/ </span>|<span class="hljs-string">   </span>|<span class="hljs-string">        =</span>|<span class="hljs-string">___ ___</span>|<span class="hljs-string">      _________________</span><br><span class="hljs-string">     /     </span>|<span class="hljs-string">  </span>|<span class="hljs-string">   H  </span>|<span class="hljs-string">  </span>|<span class="hljs-string">     </span>|<span class="hljs-string">   </span>|<span class="hljs-string">         </span>||<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>||<span class="hljs-string">     _</span>|<span class="hljs-string">                \_____A</span><br><span class="hljs-string">    </span>|<span class="hljs-string">      </span>|<span class="hljs-string">  </span>|<span class="hljs-string">   H  </span>|<span class="hljs-string">__--------------------</span>|<span class="hljs-string"> [___] </span>|<span class="hljs-string">   =</span>|<span class="hljs-string">                        </span>|<br>    |<span class="hljs-string"> ________</span>|<span class="hljs-string">___H__/__</span>|<span class="hljs-string">_____/[][]~\_______</span>|<span class="hljs-string">       </span>|<span class="hljs-string">   -</span>|<span class="hljs-string">                        </span>|<br>    |<span class="hljs-string">/ </span>|<span class="hljs-string">   </span>|<span class="hljs-string">-----------I_____I [][] []  D   </span>|<span class="hljs-string">=======</span>|<span class="hljs-string">____</span>|<span class="hljs-string">________________________</span>|_<br>  __/ =|<span class="hljs-string"> o </span>|<span class="hljs-string">=-~O=====O=====O=====O\ ____Y___________</span>|<span class="hljs-string">__</span>|<span class="hljs-string">__________________________</span>|_<br>   |<span class="hljs-string">/-=</span>|<span class="hljs-string">___</span>|<span class="hljs-string">=    </span>||<span class="hljs-string">    </span>||<span class="hljs-string">    </span>||<span class="hljs-string">    </span>|<span class="hljs-string">_____/~\___/          </span>|<span class="hljs-string">_D__D__D_</span>|<span class="hljs-string">  </span>|<span class="hljs-string">_D__D__D_</span>|<br>    \_/      \__/  \__/  \__/  \__/      \_/               \_/   \_/    \_/   \_/<br><br><span class="hljs-comment"># æäº¤å®¹å™¨å˜æ›´ç”Ÿæˆæ–°çš„é•œåƒ</span><br>chyiyaqing in ~ at chyiyaqing-PowerEdge-R720 took 2m 57s<br>âœ docker commit -m <span class="hljs-string">&quot;alpine with sl cmd&quot;</span> -a <span class="hljs-string">&quot;big_cat&quot;</span> my_alpine chyiyaqing/alpine_sl<br>sha256:79981bb43b0e638cc193570456ad93793a8cb481c8940e4fd899a0cc60a8bd46<br><br><span class="hljs-comment"># å‘å¸ƒåˆ°Docker Hub</span><br>chyiyaqing in ~ at chyiyaqing-PowerEdge-R720 took 10s<br>âœ docker push chyiyaqing/alpine_sl<br>Using default tag: latest<br>The push refers to repository [docker.io/chyiyaqing/alpine_sl]<br>102b73ff0977: Pushed<br>e2eb06d8af82: Mounted from library/alpine<br>latest: digest: sha256:500e9b9536a4fec460c487867d3cd7084da934ba37151aa122f4be438cc06d57 size: 739<br><br><span class="hljs-comment"># åœæ­¢/å¯åŠ¨å®¹å™¨</span><br>$ docker stop/start  my_alpine<br></code></pre></td></tr></table></figure></li>
<li><p><strong>Docker Tip #28</strong>: Dockerç›®å½•ç©ºé—´</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># æŸ¥çœ‹dockerå·¥ä½œæ ¹ç›®å½•</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ docker info | <span class="hljs-keyword">grep</span>  <span class="hljs-string">&#x27;Docker Root Dir&#x27;</span><br>Docker Root Dir: <span class="hljs-regexp">/var/li</span>b/docker<br><br><span class="hljs-comment"># æŸ¥çœ‹å·¥ä½œç›®å½•å ç”¨ç©ºé—´å¤§å°</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ sudo du -sh /var/lib/docker/<br><span class="hljs-number">65</span>G     /var/lib/docker/<br><br><span class="hljs-comment"># æŸ¥çœ‹dockerå ç”¨ç£ç›˜ç©ºé—´</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ docker <span class="hljs-keyword">system</span> df<br>TYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE<br>Images              <span class="hljs-number">22</span>                  <span class="hljs-number">0</span>                   <span class="hljs-number">11.07</span>GB             <span class="hljs-number">11.07</span>GB (<span class="hljs-number">100</span>%)<br>Containers          <span class="hljs-number">0</span>                   <span class="hljs-number">0</span>                   0B                  0B<br>Local Volumes       <span class="hljs-number">120</span>                 <span class="hljs-number">0</span>                   <span class="hljs-number">56.7</span>GB              <span class="hljs-number">56.7</span>GB (<span class="hljs-number">100</span>%)<br>Build Cache         <span class="hljs-number">0</span>                   <span class="hljs-number">0</span>                   0B                  0B<br><br><span class="hljs-comment"># æ¸…ç†dockeræ²¡æœ‰è¢«ä½¿ç”¨çš„dockeré•œåƒ</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ docker <span class="hljs-keyword">system</span> prune -a<br>WARNING! This will remove:<br>        - all stopped containers<br>        - all networks <span class="hljs-keyword">not</span> used by at least one container<br>        - all dangling images<br>        - all dangling build cache<br>Are you sure you want to <span class="hljs-keyword">continue</span>? [<span class="hljs-keyword">y</span>/N] <span class="hljs-keyword">y</span><br>Total reclaimed space: 0B<br><br><span class="hljs-comment"># åœæ­¢dockeræœåŠ¡</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ systemctl stop docker<br>==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ====<br>Authentication is required to stop <span class="hljs-string">&#x27;docker.service&#x27;</span>.<br>Authenticating as: hyperchain<br>Password:<br>==== AUTHENTICATION COMPLETE ====<br>[hyperchain@mini <span class="hljs-keyword">package</span>]$<br><br><span class="hljs-comment"># åˆ é™¤ volumnes</span><br>[hyperchain@mini <span class="hljs-keyword">package</span>]$ docker volume prune<br>WARNING! This will remove all <span class="hljs-keyword">local</span> volumes <span class="hljs-keyword">not</span> used by at least one container.<br>Are you sure you want to <span class="hljs-keyword">continue</span>? [<span class="hljs-keyword">y</span>/N] <span class="hljs-keyword">y</span><br>Deleted Volumes:<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="Have-a-Fun"><a href="#Have-a-Fun" class="headerlink" title="Have a Fun"></a>Have a Fun</h2><ul>
<li>Run the First Edition of Unix (1972) with Docker<blockquote>
<p>Run a PDP-11 simulator through Docker to interact with Unix as it was back in 1972</p>
</blockquote>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">$ docker <span class="hljs-keyword">run</span> --<span class="hljs-keyword">rm</span> -it bahamat/unix-1st-<span class="hljs-keyword">ed</span><br></code></pre></td></tr></table></figure></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Cloud-Native/">Cloud Native</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/09/02/echo-go-web-framework/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">echo-go-web-framework</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/09/01/hexo-next-gitalk/">
                        <span class="hidden-mobile">hexo-next-gitalk</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
